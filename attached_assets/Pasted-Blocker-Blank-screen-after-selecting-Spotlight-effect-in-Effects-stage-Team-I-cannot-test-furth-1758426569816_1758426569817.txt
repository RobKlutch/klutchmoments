Blocker. Blank screen after selecting Spotlight effect in Effects stage.

Team,

I cannot test further. After selecting the Spotlight effect in the Effects stage, the app goes to a blank screen. This is a new regression and blocks all verification of the tracking fixes.

Repro

Route: /admin/creator

Steps:

Load clip.

Timeline: select player.

Go to Effects.

Toggle Spotlight effect.

Screen goes blank.

Expected

UI stays responsive; overlay renders or shows a visible error if initialization fails.

Actual

Full white screen. No UI, no player, no controls.

Request: immediate triage and rollback plan

If a quick fix is not available, roll back to the last commit where the Effects page rendered. Provide the good and bad commit SHAs.

Diagnostics to capture in real time

Browser Console:

First error line and stack trace.

Any “Unhandled promise rejection”, “Cannot read properties of undefined”, or React hydration/runtime errors.

Network:

Failed requests around effect initialization (models, worker scripts, WASM, textures).

Performance/Memory:

Look for a runaway requestAnimationFrame loop, excessive canvas size, or WebGL context loss.

App logs:

window.onerror and unhandledrejection handlers should log to console with a unique tag so we can match timestamps.

High-probability failure points

Null/undefined access during Spotlight mount (e.g., video/container rects not ready).

rAF loop starting before refs are set; stale closure holds nulls and crashes.

Canvas size computed from NaN/undefined, causing layout and render failure.

Worker/WebAssembly or OffscreenCanvas init error not caught, leaving the React tree unmounted.

Route transition not clearing previous stage state; effect attempts to read Timeline-only state.

Hotfix guardrails to prevent full-page failure

Wrap the Effects route subtree in an ErrorBoundary with a visible fallback and a “Reload Effects” button.

Before starting rAF, validate prerequisites:

videoRef.current, contentRect, devicePixelRatio, selectedPlayerId when required.

Try/catch around overlay init and the rAF draw; on error:

Cancel rAF, log the error, show non-fatal banner, keep page interactive.

Ensure cancelAnimationFrame on unmount. Prevent multiple loops.

Gate Spotlight mount until video.readyState >= 2 and getBoundingClientRect() returns non-zero.

Verification HUD (keep enabled until closure)
Add these fields to the on-screen HUD and to console on mount:

effectsMounted, videoReady, contentRect {w,h}, canvas {w,h}, dpr

rAFStarted, rAFFrameCount

Any caught error message and last successful draw timestamp

Acceptance criteria to close this blocker

Effects page never blanks on Spotlight toggle, across:

DPR 1.0 and 2.0

Two viewport sizes

On error, UI shows fallback rather than white screen; rAF is stopped cleanly.

Provide a 20–30s screen recording showing:

Toggle Spotlight on

HUD fields above

No blank screen

Include commit SHAs for the fix.

Once the blank-screen regression is fixed, we will resume validating the previously reported tracking issues (activation timing and per-frame ID follow) against the already provided acceptance criteria.