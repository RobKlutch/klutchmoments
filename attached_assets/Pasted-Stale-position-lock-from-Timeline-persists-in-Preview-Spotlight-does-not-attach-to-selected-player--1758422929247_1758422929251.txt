Stale position lock from Timeline persists in Preview. Spotlight does not attach to selected player in playback.

Team,

I re-tested and captured the attached HUD. The system reports ID: player_10, Active: YES, Valid: YES, Pos: (0.007, 0.438), Time: 0.0s. On screen, the spotlight is locked to an empty location for the entire clip and never attaches to the selected player at the correct timestamp. There is no smooth follow during playback.

Key evidence from HUD and behavior

The position remains constant at the left even as the video plays.

HUD shows Time: 0.0s while the clip advances, suggesting the tracker sample time is not advancing or the box lookup uses a stale timebase.

Earlier HUD showed selectedActivationTime = 5.961s. The overlay still displays at 0.0s, which indicates a mismatch between Timeline selection time and Preview playback time, or state from Timeline is leaking into Preview.

The visual output contradicts “Valid: YES.” Either Valid is computed from stale state, or the per-frame ID → box join is failing.

Working hypothesis

Stale state from Timeline: the normalized coordinates captured on selection are being reused in Preview rather than sampling the detection track per frame.

Timebase mismatch: currentVideoTime in Preview is not aligned with the track time used for player_10 (missing clip start offset or using a fixed zero).

Gap-bridge freeze never releases: a freeze window intended for short gaps is persisting indefinitely, pinning the overlay to the initial selection coordinate.

ID lock semantics inconsistent: “Valid: YES” is true while no matching box is drawn, meaning the renderer and validator are using different stores or different instants.

Required fixes

Per-frame ID lookup tied to playback time

For every requestAnimationFrame, compute sampleTime = currentVideoTime + clipStartOffset.

Lookup box = getBoxByIdAtTime(selectedPlayerId, sampleTime).

If box exists, update position and reset freeze. If not, freeze last valid box for up to N frames, then hide.

Prohibit any fallback to proximity while selectedPlayerId is set.

Hard reset on stage/clip change

On entering Preview or changing selection, reset lastBox, lastTimestamp, smoothing filters, and any freeze timer. Confirm the rAF update loop starts fresh.

Single source of truth for validity and rendering

Define hasValidBoxForSelected = Boolean(box) for the current frame.

Define isSpotlightActive = hasSelectedPlayer && (isManuallySelected || currentVideoTime >= selectedActivationTime) && hasValidBoxForSelected.

Use this same computed value for both the HUD and the renderer. If they ever differ, emit an error log with all input terms.

Timebase audit

Display on HUD each frame: currentVideoTime, clipStartOffset, sampleTime, selectedActivationTime, trackingBoxId, box.timestamp.

The invariant to enforce is trackingBoxId === selectedPlayerId and abs(box.timestamp − sampleTime) ≤ frameWindow.

Freeze behavior

Show freezeActive and framesSinceLastValid on the HUD. Ensure freeze disables after N frames and never pins for the full clip.

Acceptance criteria to close

No overlay until selection or until currentVideoTime >= selectedActivationTime.

After selection, overlay follows only the selected player with smooth motion.

Quantitative: IoU with the selected player’s box ≥ 0.6 for ≥ 95% of frames over a 10 s clip at 1080p; max positional error ≤ 20 px; zero frames drawn outside the selected player while a valid box exists.

Provide a 20–30 s screen recording with the HUD enabled showing sampleTime advancing per frame, trackingBoxId === selectedPlayerId, and renderer/HUD booleans identical. Include commit SHAs.

This is still a blocker. Please confirm ownership and provide a recording with the above HUD fields visible so we can verify the per-frame ID join and timebase alignment.